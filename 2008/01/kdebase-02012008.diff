Index: runtime/kcontrol/menus/kde-settings-peripherals.directory
===================================================================
--- runtime/kcontrol/menus/kde-settings-peripherals.directory	(revisión: 0)
+++ runtime/kcontrol/menus/kde-settings-peripherals.directory	(revisión: 0)
@@ -0,0 +1,73 @@
+[Desktop Entry]
+Encoding=UTF-8
+Type=Directory
+Icon=preferences-desktop-peripherals
+Name=Peripherals
+Name[af]=Randapperatuur
+Name[ar]=الأجهزة الطرفية
+Name[be]=Перыферыя
+Name[bg]=Периферия
+Name[bn]=পেরিফেরাল
+Name[br]=Trobarzhelloù
+Name[ca]=Perifèrics
+Name[cs]=Periférie
+Name[csb]=Periferëjné ùrządzenia
+Name[cy]=Perifferolion
+Name[da]=Tilkoblinger
+Name[de]=Angeschlossene Geräte
+Name[el]=Περιφερειακά
+Name[eo]=Periferaĵoj
+Name[es]=Periféricos
+Name[et]=Välisseadmed
+Name[eu]=Periferikoak
+Name[fa]=وسایل جانبی
+Name[fi]=Oheislaitteet
+Name[fr]=Périphériques
+Name[fy]=Râneapparaten
+Name[ga]=Forimeallaigh
+Name[gl]=Periféricos
+Name[he]=ציוד היקפי
+Name[hi]=सहायक पुरजे
+Name[hr]=Periferni uređaji
+Name[hu]=Perifériák
+Name[is]=Jaðartæki
+Name[it]=Periferiche
+Name[ja]=周辺機器
+Name[ka]=პერიფერიული
+Name[kk]=Периферия
+Name[km]=គ្រឿង​កុំព្យូទ័រ
+Name[ko]=주변 장치
+Name[lt]=Periferija
+Name[lv]=Perifērija
+Name[mk]=Периферни уреди
+Name[ms]=Perkakasan
+Name[nb]=Tilleggsenheter
+Name[nds]=Reedschappen
+Name[ne]=परिधि
+Name[nl]=Randapparaten
+Name[nn]=Tilleggseiningar
+Name[pa]=ਪਾਰਿਫ਼ਾਰਲ
+Name[pl]=Urządzenia peryferyjne
+Name[pt]=Periféricos
+Name[pt_BR]=Periféricos
+Name[ro]=Periferice
+Name[ru]=Периферия
+Name[se]=Lasseovttadagat
+Name[sk]=Periférie
+Name[sl]=Strojni dodatki
+Name[sr]=Периферије
+Name[sr@latin]=Periferije
+Name[sv]=Kringutrustning
+Name[ta]=கருவிகள்
+Name[te]=పరికరాలు
+Name[tg]=Периферия
+Name[th]=อุปกรณ์ต่อพ่วง
+Name[tr]=Çevre Birimleri
+Name[uk]=Периферійні пристрої
+Name[uz]=Уланган ускуналар
+Name[vi]=Ngoại vi
+Name[wa]=Periferikes
+Name[x-test]=xxPeripheralsxx
+Name[xh]=Iilayini zomda
+Name[zh_CN]=外设
+Name[zh_TW]=週邊設備
Index: runtime/kcontrol/menus/kde-settings-looknfeel.directory
===================================================================
--- runtime/kcontrol/menus/kde-settings-looknfeel.directory	(revisión: 755475)
+++ runtime/kcontrol/menus/kde-settings-looknfeel.directory	(copia de trabajo)
@@ -72,4 +72,4 @@
 Name[xh]=Ubonakalo Nemixholo
 Name[zh_CN]=外观和主题
 Name[zh_TW]=外觀與主題
-Icon=looknfeel
+Icon=preferences-desktop-theme
Index: runtime/kcontrol/menus/kde-settings-system.directory
===================================================================
--- runtime/kcontrol/menus/kde-settings-system.directory	(revisión: 755475)
+++ runtime/kcontrol/menus/kde-settings-system.directory	(copia de trabajo)
@@ -72,4 +72,4 @@
 Name[xh]=Umphathi Wendlela yokusebenza
 Name[zh_CN]=系统管理
 Name[zh_TW]=系統管理
-Icon=kcmsystem
+Icon=preferences-system
Index: runtime/kcontrol/menus/kde-settings-components.directory
===================================================================
--- runtime/kcontrol/menus/kde-settings-components.directory	(revisión: 755475)
+++ runtime/kcontrol/menus/kde-settings-components.directory	(copia de trabajo)
@@ -71,4 +71,4 @@
 Name[xh]=Izinto ze KDE
 Name[zh_CN]=KDE 组件
 Name[zh_TW]=KDE 元件
-Icon=blockdevice
+Icon=kde
Index: runtime/kcontrol/menus/kde-settings-accessibility.directory
===================================================================
--- runtime/kcontrol/menus/kde-settings-accessibility.directory	(revisión: 755475)
+++ runtime/kcontrol/menus/kde-settings-accessibility.directory	(copia de trabajo)
@@ -70,4 +70,4 @@
 Name[xh]=Ummandla & Nofumaneko
 Name[zh_CN]=区域和辅助功能
 Name[zh_TW]=區域性與易用性
-Icon=locale
+Icon=preferences-desktop-locale
Index: runtime/kcontrol/menus/kde-settings-sound.directory
===================================================================
--- runtime/kcontrol/menus/kde-settings-sound.directory	(revisión: 755475)
+++ runtime/kcontrol/menus/kde-settings-sound.directory	(copia de trabajo)
@@ -70,4 +70,4 @@
 Name[xh]=Isandi & Multimedia
 Name[zh_CN]=声音和多媒体
 Name[zh_TW]=聲音與多媒體
-Icon=multimedia
+Icon=preferences-desktop-sound
Index: runtime/kcontrol/menus/kde-settings-network.directory
===================================================================
--- runtime/kcontrol/menus/kde-settings-network.directory	(revisión: 755475)
+++ runtime/kcontrol/menus/kde-settings-network.directory	(copia de trabajo)
@@ -72,4 +72,4 @@
 Name[xh]=Internet & Nomsebenzi womnatha
 Name[zh_CN]=互联网和网络
 Name[zh_TW]=網路
-Icon=preferences-system-network
+Icon=preferences-system-network-sharing
Index: runtime/kcontrol/menus/kde-settings-power.directory
===================================================================
--- runtime/kcontrol/menus/kde-settings-power.directory	(revisión: 755475)
+++ runtime/kcontrol/menus/kde-settings-power.directory	(copia de trabajo)
@@ -71,4 +71,4 @@
 Name[xh]=Ulawulo Lwamandla
 Name[zh_CN]=电源控制
 Name[zh_TW]=電源控制
-Icon=energy
+Icon=preferences-system-power-management
Index: runtime/kcontrol/menus/kde-settings-hardware.directory
===================================================================
--- runtime/kcontrol/menus/kde-settings-hardware.directory	(revisión: 755475)
+++ runtime/kcontrol/menus/kde-settings-hardware.directory	(copia de trabajo)
@@ -57,4 +57,4 @@
 Name[x-test]=xxHardwarexx
 Name[zh_CN]=硬件
 Name[zh_TW]=硬體
-Icon=input_devices_settings
+Icon=preferences-system
Index: runtime/kcontrol/menus/kde-settings-security.directory
===================================================================
--- runtime/kcontrol/menus/kde-settings-security.directory	(revisión: 755475)
+++ runtime/kcontrol/menus/kde-settings-security.directory	(copia de trabajo)
@@ -71,4 +71,4 @@
 Name[xh]=Ukhuseleko & Nobunikazi
 Name[zh_CN]=安全和隐私
 Name[zh_TW]=安全性與私密性
-Icon=password
+Icon=preferences-desktop-user-password
Index: runtime/kcontrol/menus/kde-settings-desktop.directory
===================================================================
--- runtime/kcontrol/menus/kde-settings-desktop.directory	(revisión: 755475)
+++ runtime/kcontrol/menus/kde-settings-desktop.directory	(copia de trabajo)
@@ -68,4 +68,4 @@
 Name[x-test]=xxDesktopxx
 Name[zh_CN]=桌面
 Name[zh_TW]=桌面
-Icon=desktop
+Icon=preferences-desktop
Index: runtime/kcontrol/menus/CMakeLists.txt
===================================================================
--- runtime/kcontrol/menus/CMakeLists.txt	(revisión: 755475)
+++ runtime/kcontrol/menus/CMakeLists.txt	(copia de trabajo)
@@ -1,8 +1,21 @@
-
-
-
 ########### install files ###############
 
-install( FILES kde-information.menu
-    DESTINATION ${SYSCONF_INSTALL_DIR}/xdg/menus/)
-install( FILES kde-information.directory  DESTINATION  ${XDG_DIRECTORY_INSTALL_DIR} )
+install( FILES kde-kcontrol.menu
+               kde-information.menu
+         DESTINATION ${SYSCONF_INSTALL_DIR}/xdg/menus/)
+install( FILES kde-information.directory
+               kde-settings.directory
+               kde-settings-accessibility.directory
+               kde-settings-components.directory
+               kde-settings-desktop.directory
+               kde-settings.directory
+               kde-settings-hardware.directory
+               kde-settings-looknfeel.directory
+               kde-settings-network.directory
+               kde-settings-power.directory
+               kde-settings-security.directory
+               kde-settings-sound.directory
+               kde-settings-system.directory
+               kde-settings-webbrowsing.directory
+               kde-settings-peripherals.directory
+         DESTINATION  ${XDG_DIRECTORY_INSTALL_DIR} )
Index: runtime/kioslave/settings/kio_settings.cc
===================================================================
--- runtime/kioslave/settings/kio_settings.cc	(revisión: 755475)
+++ runtime/kioslave/settings/kio_settings.cc	(copia de trabajo)
@@ -146,7 +146,10 @@
 	KService::Ptr service = KService::serviceByDesktopName(url.fileName());
 	if (service && service->isValid()) {
 		KUrl redirUrl;
-		redirUrl.setPath(KStandardDirs::locate("apps", service->entryPath()));
+        if ( m_runMode == SettingsMode )
+            redirUrl.setPath(KStandardDirs::locate("services", service->entryPath()));
+        else
+		    redirUrl.setPath(KStandardDirs::locate("apps", service->entryPath()));
 		redirection(redirUrl);
 		finished();
 	} else {
@@ -176,9 +179,10 @@
 //			KUrl newUrl;
 //			newUrl.setPath(KStandardDirs::locate("apps", service->entryPath()));
 //			createFileEntry(entry, service->name(), newUrl, "application/x-desktop", service->icon());
-
-			createFileEntry(entry, service->name(), url.url( KUrl::AddTrailingSlash )+service->desktopEntryName(),
-                            "application/x-desktop", service->icon(), KStandardDirs::locate("apps", service->entryPath()) );
+            if ( m_runMode == SettingsMode )
+                createFileEntry(entry, service->name(), url.url( KUrl::AddTrailingSlash )+service->desktopEntryName(), "application/x-desktop", service->icon(), KStandardDirs::locate("services", service->entryPath()) );
+            else
+			    createFileEntry(entry, service->name(), url.url( KUrl::AddTrailingSlash )+service->desktopEntryName(), "application/x-desktop", service->icon(), KStandardDirs::locate("apps", service->entryPath()) );
 		} else {
 			error(KIO::ERR_SLAVE_DEFINED,i18n("Unknown settings folder"));
 			return;
@@ -198,7 +202,6 @@
 
 	if ( m_runMode == SettingsMode)
 		groupPath.prepend("Settings/");
-
 	KServiceGroup::Ptr grp = KServiceGroup::group(groupPath);
 
 	if (!grp || !grp->isValid()) {
@@ -217,6 +220,8 @@
 			KServiceGroup::Ptr g(KServiceGroup::Ptr::staticCast(e));
 			QString groupCaption = g->caption();
 
+            kDebug() << "ADDING SERVICE GROUP WITH PATH " << g->relPath();
+
 			// Avoid adding empty groups.
 			KServiceGroup::Ptr subMenuRoot = KServiceGroup::group(g->relPath());
 			if (subMenuRoot->childCount() == 0)
@@ -239,7 +244,7 @@
 			{
 			  case( SettingsMode ):
 				relPath.remove(0, 9); // length("Settings/") ==9
-				kDebug() << "SettingsProtocol: adding entry settings:/" << relPath;
+				kDebug() << "SettingsProtocol: adding entry settings:/" << relPath << " with icon " << g->icon();
 				createDirEntry(entry, groupCaption, "settings:/"+relPath, "inode/directory",g->icon());
 				break;
 			  case( ProgramsMode ):
@@ -247,15 +252,26 @@
 				createDirEntry(entry, groupCaption, "programs:/"+relPath, "inode/directory",g->icon());
 				break;
 			  case( ApplicationsMode ):
-				kDebug() << "SettingsProtocol: adding entry applications:/" << relPath;
+                kDebug() << "SettingsProtocol: adding entry applications:/" << relPath << " with icon " << g->icon();
 				createDirEntry(entry, groupCaption, "applications:/"+relPath, "inode/directory",g->icon());
 				break;
 		    }
 
 		} else {
 			KService::Ptr s(KService::Ptr::staticCast(e));
-			kDebug() << "SettingsProtocol: adding file entry " << url.url( KUrl::AddTrailingSlash )+s->name();
-			createFileEntry(entry,s->name(),url.url( KUrl::AddTrailingSlash )+s->desktopEntryName(), "application/x-desktop",s->icon(),KStandardDirs::locate("apps", s->entryPath()));
+
+            kDebug() << "the entry name is " << s->desktopEntryName()
+                     << "with path " << s->entryPath();
+
+            if (s->isApplication())
+                continue;
+
+			kDebug() << "SettingsProtocol: adding file entry " << url.url( KUrl::AddTrailingSlash )+s->name() << " with icon " << s->icon();
+
+            if ( m_runMode == SettingsMode )
+                createFileEntry(entry,s->name(),url.url( KUrl::AddTrailingSlash )+s->desktopEntryName(), "application/x-desktop",s->icon(),KStandardDirs::locate("services", s->entryPath()));
+            else
+			    createFileEntry(entry,s->name(),url.url( KUrl::AddTrailingSlash )+s->desktopEntryName(), "application/x-desktop",s->icon(),KStandardDirs::locate("apps", s->entryPath()));
 		}
 
 		listEntry(entry, false);
Index: workspace/menu/desktop/kde-development-translation.directory
===================================================================
--- workspace/menu/desktop/kde-development-translation.directory	(revisión: 755475)
+++ workspace/menu/desktop/kde-development-translation.directory	(copia de trabajo)
@@ -71,78 +71,3 @@
 Name[zh_CN]=翻译
 Name[zh_TW]=翻譯
 Icon=applications-development-translation
-
-[Desktop Entry]
-Encoding=UTF-8
-Type=Directory
-Name=Translation
-Name[af]=Vertaling
-Name[ar]=ترجمة
-Name[be]=Пераклад
-Name[bg]=Превод
-Name[bn]=অনুবাদ
-Name[br]=Troidigezh
-Name[ca]=Traducció
-Name[cs]=Překlad
-Name[csb]=Dolmaczënk
-Name[cy]=Cyfieithiad
-Name[da]=Oversættelse
-Name[de]=Übersetzung
-Name[el]=Μετάφραση
-Name[eo]=Traduko
-Name[es]=Traducción
-Name[et]=Tõlkimine
-Name[eu]=Itzulpengintza
-Name[fa]=ترجمه
-Name[fi]=Käännös
-Name[fr]=Traduction
-Name[fy]=Oersetting
-Name[ga]=Aistriúchán
-Name[gl]=Tradución
-Name[he]=תרגום
-Name[hi]=अनुवाद 
-Name[hr]=Prijevod
-Name[hu]=Fordítás
-Name[is]=Þýðing
-Name[it]=Traduzione
-Name[ja]=翻訳
-Name[ka]=თარგმნა
-Name[kk]=Аудару
-Name[km]=ការបកប្រែ
-Name[ko]=번역
-Name[ku]=Wergerandin
-Name[lt]=Vertimas
-Name[lv]=Tulkošana
-Name[mk]=Превод
-Name[ms]=Terjemahan
-Name[nb]=Oversettelse
-Name[nds]=Översetten
-Name[ne]=अनुवाद
-Name[nl]=Vertaling
-Name[nn]=Omsetjing
-Name[oc]=Revirada
-Name[pa]=ਟਰਾਂਸਲੇਸ਼ਨਦ
-Name[pl]=Tłumaczenie
-Name[pt]=Tradução
-Name[pt_BR]=Tradução
-Name[ro]=Traducere
-Name[ru]=Перевод
-Name[se]=Jorgalus
-Name[sk]=Preklad
-Name[sl]=Prevajanje
-Name[sr]=Превод
-Name[sr@latin]=Prevod
-Name[sv]=Översättning
-Name[te]=అనువాదం
-Name[tg]=Тарҷума
-Name[th]=เครื่องมือแปลภาษา
-Name[tr]=Çeviri
-Name[uk]=Переклад
-Name[uz]=Таржима
-Name[vi]=Dịch
-Name[wa]=Ratournaedje
-Name[x-test]=xxTranslationxx
-Name[zh_CN]=翻译
-Name[zh_TW]=翻譯
-Icon=applications-development-translation
-
Index: workspace/menu/desktop/kde-development-webdevelopment.directory
===================================================================
--- workspace/menu/desktop/kde-development-webdevelopment.directory	(revisión: 755475)
+++ workspace/menu/desktop/kde-development-webdevelopment.directory	(copia de trabajo)
@@ -68,75 +68,3 @@
 Name[zh_CN]=Web 开发
 Name[zh_TW]=網頁開發
 Icon=applications-development-web
-
-[Desktop Entry]
-Encoding=UTF-8
-Type=Directory
-Name=Web Development
-Name[af]=Web Ontwikkeling
-Name[ar]=تطوير الشبكة
-Name[be]=Web-распрацоўка
-Name[bg]=Уеб разработка
-Name[bn]=ওয়েব ডেভেলপমেন্ট
-Name[br]=Diorren gwiad
-Name[ca]=Desenvolupament Web
-Name[cs]=Webový vývoj
-Name[csb]=Programòwanié WWW
-Name[da]=Internet-udvikling
-Name[de]=Web-Entwicklung
-Name[el]=Δικτυακή ανάπτυξη
-Name[eo]=Reta programado
-Name[es]=Desarrollo web
-Name[et]=Veebiarendus
-Name[eu]=Web garapena
-Name[fa]=توسعۀ وب
-Name[fi]=Webin kehitys
-Name[fr]=Développement Internet
-Name[fy]=Webûntwikkeling
-Name[ga]=Forbairt Ghréasáin
-Name[gl]=Desenvolvemento web
-Name[he]=פיתוח Web
-Name[hi]=वेब स्थल विकास
-Name[hr]=Web razvoj
-Name[hu]=Webes fejlesztőeszközök
-Name[is]=Vefhönnun
-Name[it]=Sviluppo web
-Name[ja]=ウェブ開発
-Name[ka]=ვებ პროგრამირება
-Name[kk]=Веб жобалау
-Name[km]=ការ​​អភិវឌ្ឍន៍​បណ្តាញ
-Name[ko]=웹 개발
-Name[lt]=Žiniatinklio programavimas
-Name[lv]=Tīmekļa izstrāde
-Name[mk]=Веб-развој
-Name[ms]=Pembangunan Web
-Name[nb]=Nettutvikling
-Name[nds]=Nett-Utwickeln
-Name[ne]=वेब विकास
-Name[nl]=Webontwikkeling
-Name[nn]=Nettutvikling
-Name[pa]=ਵੈੱਬ ਡਿਵੈਲਪਮੈਂਟ
-Name[pl]=Programowanie WWW
-Name[pt]=Desenvolvimento Web
-Name[pt_BR]=Desenvolvimento Web
-Name[ro]=Dezvoltare web
-Name[ru]=Разработка Web
-Name[se]=Fierpmádatovdánahttin
-Name[sk]=Vývoj pre Web
-Name[sl]=Spletni razvoj
-Name[sr]=Развој за Веб
-Name[sr@latin]=Razvoj za Web
-Name[sv]=Webbutveckling
-Name[te]=వెబ్ డెవలప్ మెంట్
-Name[tg]=Созандагии Вэб
-Name[th]=พัฒนาเว็บ
-Name[tr]=Web Geliştirme
-Name[uk]=Розробка веб-сторінок
-Name[uz]=Веб учун тузиш
-Name[vi]=Phát triển Mạng
-Name[wa]=Disvelopmint waibe
-Name[x-test]=xxWeb Developmentxx
-Name[zh_CN]=Web 开发
-Name[zh_TW]=網頁開發
-Icon=applications-development-web
-
